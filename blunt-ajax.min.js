function bluntAjax(e){function g(){var e=false;try{e=new XMLHttpRequest}catch(t){var n=new Array("MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.5.0","MSXML2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP");for(var r=0;r<n.length&&!e;r++){try{e=new ActiveXObject(n[r])}catch(t){}}}return e}function y(){var e=false;var r;if(m){c=true;if(u=="GET"){if(o!=""){n=n+"?"+o}r=null}else{r=o}try{m.open(u,n,true);m.onreadystatechange=b;if(u=="POST"){m.setRequestHeader("Content-type","application/x-www-form-urlencoded");m.setRequestHeader("Content-length",r.length);m.setRequestHeader("Connection","close")}m.send(r)}catch(i){d="Error sending request";e=true}}if(e){bluntAjaxReturn(s,v,a,f,c,p,d,h,t)}}function b(){var e=false;h="";if(m.readyState==4){if(m.status==200){p=200;d=m.statusText;try{v=m.responseText}catch(n){h=n.toString()}}else{p=m.status;d=m.statusText}bluntAjaxReturn(s,v,a,f,c,p,d,h,t)}}if(!bluntAjaxOptions){return}var t=bluntAjaxOptions.debug;var n=bluntAjaxOptions.url;var r=false;var s=bluntAjaxDefaultCallback;var o="";var u="GET";var a=false;var f=false;for(i in e){switch(i){case"debug":if(typeof e[i]=="boolean"){t=e[i]}else{r=true;if(t){alert("Blunt Ajax: "+e[i]+" is not a valid value for debug")}}break;case"url":if(e[i]&&typeof e[i]=="string"){n=e[i]}else{r=true;if(t){alert("Blunt Ajax: "+e[i]+" is not a valid URL")}}break;case"callback":if(e[i]&&typeof e[i]=="function"){s=e[i]}else{r=true;if(t){alert("Blunt Ajax: "+e[i]+" is not a function")}}break;case"method":if(e[i]&&typeof e[i]=="string"){var l=e[i];l=l.toUpperCase();if(l=="POST"||l=="GET"){u=e[i]}else{r=true;if(t){alert("Blunt Ajax: "+e[i]+" is not a valid method")}}}else{r=true;if(t){alert("Blunt Ajax: "+e[i]+" is not a valid method")}}break;case"element_id":if(e[i]&&typeof document.getElementById(e[i])!="undefined"){a=e[i]}else{r=true;if(t){alert("Blunt Ajax: "+e[i]+" is not a valid element id in this document")}}break;case"parameters":if(e[i]&&typeof e[i]=="object"){for(j in e[i]){if(o!=""){o+="&"}o+=j+"="+e[i][j]}}else{r=true;if(t){alert("Blunt Ajax: the value supplied for parameters is not a valid Object")}}break;case"pass":f=e[i];break;default:break}}if(r){return}var c=false;var h=false;var p=false;var d=false;var v=false;var m=g();y()}function bluntAjaxReturn(e,t,n,r,i,s,o,u,a){if(i){if(s==200){if(u==""){e(t,n,r)}else if(a){alert("Blunt Ajax: "+u)}}else if(a){alert("Blunt Ajax: "+s+": "+o)}}else if(a){alert("Blunt Ajax: Failed to create an http connection!")}}function bluntAjaxDefaultCallback(e,t,n){if(t!==false){document.getElementById(t).innerHTML=e}else{alert(e)}}